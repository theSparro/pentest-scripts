# Use VBoxManage to import Mobexler VM from ova file
$virtualMachine = "Mobexler"
$pathToFile = "C:Users\joelw\Downloads\Mobexler.ova"
VBoxManage import $pathToFile --vsys 0 --eula accept --vmname $virtualMachine

# Use VBoxManage to import Kali VM from .vbox file and .vdi
$virtualMachine = "Kali"
$pathToFile = "C:Users\joelw\Downloads\kali-linux-2023.2-virtualbox-amd64.vbox"
VBoxManage import $pathToFile --vsys 0 --vmname $virtualMachine

# Function to create a shared folder between host and guest
function CreateEngagementFolder {
    param (
        [string]$virtualMachine,
        [string]$sharedFolderName,
        [string]$sharedFolderPath
    )
    # Create shared folder on host and set to auto-mount on guest
    VBoxManage sharedfolder add $virtualMachine --name $sharedFolderName --hostpath $sharedFolderPath --automount
}

VBoxManage sharedfolder add Mobexler --name "SetUpScripts" --hostpath "C:\Users\joelw\Downloads\VboxShare" --automount

# The User Needs to be added to the vboxsf group to have permission to access the shared folder. This is done on Linux by the command sudo adduser $USER vboxsf

