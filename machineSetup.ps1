# If Machine Execution Policy does not allow Powershell scripts to run, use the following command
# Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser

# Install Chocolatey
Set-ExecutionPolicy Bypass -Scope Process -Force; 
[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; 
Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

$appsList = (
    "virtualbox"
)

# Install Apps
foreach ($App in $appsList) {
    choco install $App -y #--force
}

# Refresh the environment variables
Import-Module $env:ChocolateyInstall\helpers\chocolateyProfile.psm1; Update-SessionEnvironment

# Copy over files from thumb drive
$sourcePath = "D:\"
$destinationPath = "C:\Pentesting\"

if (Test-Path $sourcePath) {
    if (-not (Test-Path $destinationPath)) {
        New-Item -ItemType Directory -Force -Path $destinationPath
    }

    Copy-Item -Path "$sourcePath\*" -Destination $destinationPath -Force -Recurse

    Write-Host "Items copied successfully from the flash drive."
} else {
    Write-Host "Source path not found. Please make sure the thumb drive is connected and try again."
}

# Download files from server/repository