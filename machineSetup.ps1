# If Machine Execution Policy does not allow Powershell scripts to run, use the following command:
# Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser

# Install Chocolatey
Set-ExecutionPolicy Bypass -Scope Process -Force; 
[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; 
Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

# List of apps to be installed
$appsList = (
    "virtualbox"
)

# Install Apps
foreach ($App in $appsList) {
    choco install $App -y
}

# Refresh the environment variables
Import-Module $env:ChocolateyInstall\helpers\chocolateyProfile.psm1; Update-SessionEnvironment

# Create a directory for pentesting engagements
$directoryPath = "C:\Engagements\";
if (-not (Test-Path $directoryPath)) {
    New-Item -ItemType Directory -Force -Path $directoryPath
}
