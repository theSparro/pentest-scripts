$Python = "Python.Python.3.9"
# $AnsibleCoreVersion = "2.15.2"
$AnsibleVersion = "8.2.0"

"Installing $Python"
winget install --accept-source-agreements --accept-package-agreements -e --id $Python 
# Reload PATH
[Environment]::SetEnvironmentVariable('PATH', [Environment]::GetEnvironmentVariable('PATH', 'Machine') + ';' + [Environment]::GetEnvironmentVariable('PATH', 'User'), 'Process')
# Use Python to install Ansible
Write-Host "Installing Ansible..."
# pip install ansible-core==$AnsibleCoreVersion

python -m pip install --user ansible==$AnsibleVersion

# Add Ansible to PATH and reload PATH
function Add-Path($Path) {
    $Path = [Environment]::GetEnvironmentVariable("PATH", "Machine") + [IO.Path]::PathSeparator + $Path
    [Environment]::SetEnvironmentVariable( "Path", $Path, "Machine" )
}
$Path = "C:\Users\%UserProfile%\AppData\Roaming\Python\Python39\Scripts"
Add-Path($Path)

# Install winget packages
# General Tools
$Apps = (
    "Docker.DockerDesktop",
    "Microsoft.PowerToys",
    "Microsoft.WindowsTerminal",
    "Microsoft.VisualStudioCode",
    "Oracle.VirtualBox",
    "VMware.WorkstationPlayer"
)

$Apps | ForEach-Object {
    winget install --accept-source-agreements --accept-package-agreements -e --id $_
} 

# List of Android Tools Winget IDs
$AndroidTestingTools = (
    "AndroidStudio.AndroidStudio",
    "Google.AndroidStudioPreview",
    "Google.AndroidEmulator",
    "Google.AndroidSDKBuildTools",
    "Google.AndroidSDKPlatformTools",
    "Google.AndroidSDKTools",
    "Google.AndroidNDK64bit",
    "Google.AndroidNDK32bit"
)

$AndroidTestingTools | ForEach-Object {
    winget install --accept-source-agreements --accept-package-agreements -e --id $_
}
